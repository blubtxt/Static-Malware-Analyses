#Creates the HTML File
import os,datetime

def createFile(filepath):
    
    fileName = os.path.basename(filepath)
    
    htmlPath = filepath + ".html"
    html = open(htmlPath,'w')
    
    struct = """<!doctype html>
                <html>
                <head><style type="text/css">
                body { background-color:#E0E0E0; font-family:Arial; }
                #toplink { right:0; position:fixed; bottom:0px; }
                </style>"""
   
    title = """<title>Static Malware Analysis - %s</title></head>
                <body>"""%fileName
                
    links = """<ul>
              <li><a href = '#globals'>File Informations</a></li>
              <li><a href = '#checksums'>File Checksums</a></li>
              <li><a href = '#sections'>Sections</a></li>
              <li><a href = '#strings'>Strings</a></li>
              <li><a href = '#imports'>Imports</a></li>
              <li><a href = '#virus'>VirusTotal</a></li>
              </ul>"""
              
    time = datetime.datetime.now()
    
    top = """<div id='toplink'><b><a href="#">TOP</a></b> created %s </div>"""%time.strftime("%Y-%m-%d %H:%M")
    
    html.write("%s %s %s %s" %(struct,title,links,top))
    html.write("<b><a id='globals'>File Informations:</a></b><br>File Name: %s<br>" %fileName)
    
    return html

def closeFile(html):
    
    end = """</body>
             </html>"""
                
    html.write(end)

def insertSeperator(html):
    
    sep = """<hr style="float:left; width:100%; height:1px; border:1px solid; border-color:#2c2c2c;">"""
    
    html.write(sep)